<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>Ø·Ù…ÙÙ†ÙŠ | Ø§Ù„Ø´Ø§Øª Ø¨ÙˆØª</title>
<style>
/* Ø§Ù†Ø³Ø® ÙƒÙ„ CSS Ù…Ù† index.html Ø§Ù„Ø®Ø§Øµ Ø¨Ø§Ù„Ù€ navbar */
body { margin:0; font-family:Cairo,sans-serif; background-color:#F2F3F0; color:#333; }
.navbar { background-color:#7CAAA2; display:flex; justify-content:space-between; align-items:center; padding:12px 10%; box-shadow:0 2px 8px rgba(0,0,0,0.08); position:sticky; top:0; z-index:100; border-radius:0 0 16px 16px; }
.logo { font-size:1.6rem; font-weight:bold; color:#F9F9F9; }
.navbar ul { list-style:none; display:flex; gap:20px; margin:0; padding:0; align-items:center; }
.navbar li { position:relative; }
.navbar a { color:#fff; text-decoration:none; font-weight:500; padding:8px 14px; border-radius:8px; transition:0.3s ease; }
.navbar a:hover { background-color: rgba(255,255,255,0.15); }
.emergency-link { background-color:#4E6B68; color:#fff !important; font-weight:600; padding:8px 18px; border-radius:12px; box-shadow:0 4px 12px rgba(78,107,104,0.3); transition:0.3s ease, transform 0.2s ease; }
.emergency-link:hover { background-color:#90B7B0; transform:translateY(-2px); }
.accordion-menu { position:relative; }
.accordion-toggle { cursor:pointer; user-select:none; font-weight:600; }
.accordion-content { display:flex; flex-direction:column; position:absolute; top:100%; right:0; background-color:#F2F3F0; border-radius:16px; box-shadow:0 8px 20px rgba(0,0,0,0.1); overflow:hidden; max-height:0; opacity:0; transform:translateY(-10px); transition:max-height 0.4s ease, opacity 0.4s ease, transform 0.3s ease; z-index:99; width:220px; }
.accordion-content.show { max-height:1000px; opacity:1; transform:translateY(0); }
.accordion-content li { list-style:none; }
.accordion-content li a { padding:12px 18px; color:#2E3A3D; font-weight:500; text-decoration:none; border-bottom:1px solid rgba(0,0,0,0.08); transition:background 0.3s, padding-left 0.3s; }
.accordion-content li:last-child a { border-bottom:none; }
.accordion-content li a:hover { background-color:#E7F1EF; padding-left:28px; }
#bot-persona-input button {
  padding: 8px 16px;
  border-radius: 12px;
  border: none;
  background-color: #4E6B68;
  color: #fff;
  cursor: pointer;
  font-weight: 500;
  transition: 0.3s;
}
#bot-persona-input button:hover {
  background-color: #7CAAA2;
}

</style>
</head>
<body>

<header class="navbar">
  <div class="logo">Ø·Ù…ÙÙ†ÙŠ</div>
  <nav>
    <ul>
      <li><a href="index.html">Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠØ©</a></li>
      <li><a href="about.html">Ø¹Ù†Ù‘Ø§</a></li>
      <li class="accordion-menu">
        <span class="accordion-toggle">Ù…Ù…ÙŠØ²Ø§ØªÙ†Ø§ â–¼</span>
        <ul class="accordion-content">
          <li><a href="library.html">Ø§Ù„Ù…ÙƒØªØ¨Ø©</a></li>
          <li><a href="tests.html">Ø§Ù„Ø§Ø®ØªØ¨Ø§Ø±Ø§Øª</a></li>
          <li><a href="mood-tracker.html">Ù…ØªØ§Ø¨Ø¹Ø© Ø§Ù„Ù…Ø²Ø§Ø¬</a></li>
          <li><a href="stories.html">Ù‚ØµØµ Ø§Ù„Ù…Ø±Ø§Ù‡Ù‚ÙŠÙ†</a></li>
          <li><a href="forum.html">Ø§Ù„Ù…Ù†ØªØ¯Ù‰</a></li>
        </ul>
      </li>
      <li><a href="emergency.html" class="emergency-link">Ø§Ù„Ø·ÙˆØ§Ø±Ø¦ Ø§Ù„Ù†ÙØ³ÙŠØ©</a></li>
      <li><a href="chat.html">Ø§Ù„Ø´Ø§Øª Ø¨ÙˆØª</a></li>
    </ul>
  </nav>
</header>


<script>
const toggles = document.querySelectorAll('.accordion-toggle');
toggles.forEach(toggle => {
  toggle.addEventListener('click', (e) => {
    e.stopPropagation();
    const content = toggle.nextElementSibling;
    document.querySelectorAll('.accordion-content').forEach(menu => {
      if(menu !== content) menu.classList.remove('show');
    });
    content.classList.toggle('show');
  });
});
document.addEventListener('click', () => {
  document.querySelectorAll('.accordion-content').forEach(menu => menu.classList.remove('show'));
});
</script>


<style>
body {
  font-family: Cairo, sans-serif;
  background-color: #F2F3F0;
  margin: 0;
  display: flex;
  flex-direction: column;
  min-height: 100vh;
}

.navbar {
  background-color: #7CAAA2;
  display: flex;
  justify-content: space-between;
  align-items: center;
  padding: 12px 5%;
  box-shadow: 0 2px 6px rgba(0,0,0,0.1);
}

.navbar .logo { color: #fff; font-size: 1.6rem; font-weight: bold; }

.chat-container {
  max-width: 400px;      /* Ø¹Ø±Ø¶ Ù…Ø­Ø¯ÙˆØ¯ */
  width: 90%;
  margin: 40px auto;
  background-color: #fff;
  border-radius: 20px;   /* Ø­ÙˆØ§Ù Ù…Ø¯ÙˆØ±Ø© Ø²ÙŠ Ø§Ù„ØµÙˆØ±Ø© */
  box-shadow: 0 8px 24px rgba(0,0,0,0.15); /* Ø¸Ù„ Ø®ÙÙŠÙ */
  overflow: hidden;
  border: 1px solid #E0E0E0;
  display: flex;
  flex-direction: column;
}

.chat-header {
  background-color: #4E6B68;
  color: #fff;
  text-align: center;
  padding: 16px;
  font-weight: bold;
  font-size: 1.1rem;
}

.chat-messages {
  flex: 1;
  padding: 16px;
  display: flex;
  flex-direction: column;
  gap: 12px;
  overflow-y: auto;
}

.message {
  max-width: 80%;
  padding: 10px 14px;
  border-radius: 16px;
  font-size: 0.95rem;
}

.user { background-color: #7CAAA2; color: #fff; align-self: flex-end; }
.bot { background-color: #F9F9F9; color: #333; align-self: flex-start; border: 1px solid #E0E0E0; }

.chat-input {
  display: flex;
  padding: 12px;
  gap: 8px;
  border-top: 1px solid #E0E0E0;
  background-color: #f8f8f8;
}
.chat-input input {
  flex: 1;
  padding: 10px 14px;
  border-radius: 12px;
  border: 1px solid #ccc;
}

.chat-input button {
  padding: 10px 16px;
  background-color: #4E6B68;
  color: #fff;
  border: none;
  border-radius: 12px;
  cursor: pointer;
}
.chat-input button:hover { background-color: #7CAAA2; }
.chat-buttons {
  display: flex;
  gap: 8px;
  flex-wrap: wrap;
  justify-content: center;
  padding: 12px;
}

.chat-buttons button {
  background-color: #E7F1EF;
  color: #2E3A3D;
  border: none;
  padding: 8px 12px;
  border-radius: 12px;
  cursor: pointer;
  transition: 0.3s;
}
.chat-buttons button:hover {
  background-color: #D4EBE6;
}

/* Ø§Ø³Ù… Ø§Ù„Ø¨ÙˆØª */
#bot-name-input {
  display: flex;
  gap: 8px;
  padding: 12px;
  justify-content: center;
  align-items: center;
  background-color: #E7F1EF;
  flex-wrap: wrap;
}
#bot-name-input input {
  padding: 6px 10px;
  border-radius: 6px;
  border: 1px solid #ccc;
  flex: 1 1 150px;
}
#bot-name-input button {
  padding: 6px 12px;
  border-radius: 6px;
  border: none;
  background-color: #4E6B68;
  color: #fff;
  cursor: pointer;
}
#bot-name-input button:hover { background-color: #7CAAA2; }

/* ----- Responsive ----- */
@media (max-width: 768px) {
  .chat-container {
    width: 95%;
    margin: 10px auto;
  }
  .chat-input input, #bot-name-input input {
    font-size: 0.9rem;
  }
  .chat-header {
    font-size: 1rem;
  }
}
</style>
</head>
<body>


<!-- Ø§Ø®ØªÙŠØ§Ø± Ø§Ø³Ù… Ø§Ù„Ø¨ÙˆØª -->
<div id="bot-name-input">
  <input type="text" id="botName" placeholder="Ø§ÙƒØªØ¨ Ø§Ø³Ù… Ø§Ù„Ø¨ÙˆØª Ø§Ù„Ù„ÙŠ ØªØ­Ø¨Ù‡">
  <button onclick="setBotName()">Ø§Ø®ØªÙŠØ§Ø± Ø§Ù„Ø§Ø³Ù…</button>
</div>

<!-- Ø§Ø®ØªÙŠØ§Ø± Ø´Ø®ØµÙŠØ© Ø§Ù„Ø¨ÙˆØª -->
<div id="bot-persona-input" style="display:none; flex-direction:column; gap:10px; text-align:center; margin:20px 0;">
  <h3>Ø§Ø®ØªØ§Ø± Ø´Ø®ØµÙŠØ© Ø§Ù„Ø¨ÙˆØª Ø§Ù„Ù„ÙŠ ØªØ­Ø¨ ØªØªÙƒÙ„Ù… Ù…Ø¹Ø§Ù‡Ø§:</h3>
  <div style="display:flex; gap:10px; justify-content:center; flex-wrap:wrap;">
    <button onclick="setBotPersona('Ø§Ù„Ø¯ÙƒØªÙˆØ±')">Ø§Ù„Ø¯ÙƒØªÙˆØ±</button>
    <button onclick="setBotPersona('Ø§Ù„ØµØ§Ø­Ø¨')">Ø§Ù„ØµØ§Ø­Ø¨</button>
    <button onclick="setBotPersona('Ø§Ù„Ø£Ø®Øª')">Ø§Ù„Ø£Ø®Øª</button>
    <button onclick="setBotPersona('Ø§Ù„Ø£Ø®')">Ø§Ù„Ø£Ø®</button>
    <button onclick="setBotPersona('Ø§Ù„Ù„Ø·Ù')">Ø§Ù„Ù„Ø·Ù</button>
  </div>
</div>

<div class="chat-container">
  <div class="chat-header">ğŸŒ¸ Ø·Ù…ÙÙ†ÙŠ ChatBot</div>
  <div class="chat-messages" id="chatMessages"></div>

  <div class="chat-buttons">
    <button>Ù…Ø±Ø­Ø¨Ø§ </button>
    <button>Ø§Ø±ÙŠØ¯ Ø§Ù† Ø§Ø®Ø¨Ø±Ùƒ Ø´ÙŠØ¦Ø§</button>
    <button>Ø§Ù†Ø§ Ø§Ø´Ø¹Ø± Ø¨Ø§Ù„Ø­Ø²Ù†</button>
  </div>

  <div class="chat-input">
    <input type="text" id="userInput" placeholder="Ø§ÙƒØªØ¨ Ø±Ø³Ø§Ù„ØªÙƒ Ù‡Ù†Ø§..." onkeydown="if(event.key==='Enter'){sendMessage();}">
    <button onclick="sendMessage()">Ø¥Ø±Ø³Ø§Ù„</button>
  </div>
</div>


<script>
const botResponses = {
  "Ø§Ù„Ø¯ÙƒØªÙˆØ±": [
    "Ø®Ù„ÙŠÙ†Ø§ Ù†ÙÙƒØ± Ù…Ø¹ Ø¨Ø¹Ø¶ Ø¨Ù‡Ø¯ÙˆØ¡ Ø¹Ù† Ø§Ù„Ù„ÙŠ Ù…Ø¶Ø§ÙŠÙ‚Ùƒ...",
    "Ø£Ù†Ø§ Ù…ÙˆØ¬ÙˆØ¯ Ù‡Ù†Ø§ Ù„Ù…Ø³Ø§Ø¹Ø¯ØªÙƒ ØªÙÙ‡Ù… Ø´Ø¹ÙˆØ±Ùƒ ğŸŒ¿",
    "Ø£Ø­ÙŠØ§Ù†Ù‹Ø§ Ø¨Ø³ Ø§Ù„Ø­ÙˆØ§Ø± Ù…Ø¹ Ø­Ø¯ Ù…Ù…ÙƒÙ† ÙŠØ®ÙÙ Ø§Ù„Ø¶ØºØ· Ø§Ù„Ù†ÙØ³ÙŠ",
    "Ø­Ø³ÙŠØª Ø¨Ø­Ø§Ø¬Ø© Ù…Ø¶Ø§ÙŠÙ‚Ø§ÙƒØŸ Ø§Ø­ÙƒÙŠÙ„ÙŠ Ø¨Ø§Ù„ØªÙØµÙŠÙ„ØŒ Ø®Ø·ÙˆØ© Ø®Ø·ÙˆØ©"
  ],
  "Ø§Ù„ØµØ§Ø­Ø¨": [
    "Ø­Ø³ÙŠØª Ø¥Ù†Ùƒ Ø²Ø¹Ù„Ø§Ù†ØŒ Ø£Ù†Ø§ Ù…Ø¹Ø§Ùƒ â¤ï¸",
    "ØªØ¹Ø§Ù„Ù‰ Ù†Ø¶Ø­Ùƒ Ø´ÙˆÙŠØ©ØŒ Ø§Ù„Ø¯Ù†ÙŠØ§ Ù…Ø´ Ø¯Ø§ÙŠÙ…Ù‹Ø§ ÙƒØ¯Ù‡ ğŸ˜",
    "Ø£Ù†Ø§ Ø¬Ù†Ø¨ÙƒØŒ Ù…ØªÙ‚Ù„Ù‚Ø´",
    "Ù…Ù…ÙƒÙ† Ù†Ø­ÙƒÙŠ Ø¹Ù† Ø£ÙŠ Ø­Ø§Ø¬Ø© ØªØ­Ø¨Ù‡Ø§"
  ],
  "Ø§Ù„Ø£Ø®Øª": [
    "ÙŠØ§ Ø­Ø¨ÙŠØ¨ÙŠØŒ Ø£Ù†Ø§ Ø¬Ù†Ø¨Ùƒ ÙˆÙ…Ø³Ù…Ø¹ØªÙƒ ğŸ’›",
    "Ø­Ø³ÙŠØª Ø¥Ù†Ùƒ Ù…Ø­ØªØ§Ø¬ Ø­Ø¶Ù† Ø§ÙØªØ±Ø§Ø¶ÙŠ ğŸ¤—",
    "Ø®Ø¯ ÙˆÙ‚ØªÙƒ ÙˆØ´Ø§Ø±Ùƒ Ø§Ù„Ù„ÙŠ Ø¬ÙˆØ§ÙƒØŒ Ø£Ù†Ø§ Ø³Ø§Ù…Ø¹Ø©",
    "Ø£Ù†Ø§ Ù‡Ù†Ø§ Ø¹Ø´Ø§Ù†Ùƒ Ø¯Ø§ÙŠÙ…Ù‹Ø§ ğŸŒ¸"
  ],
  "Ø§Ù„Ø£Ø®": [
    "Ù…ØªÙ‚Ù„Ù‚Ø´ØŒ Ø£Ù†Ø§ Ù…Ø¹Ø§Ùƒ ÙˆÙ‡Ø·Ù…Ù†Ùƒ ğŸ˜Œ",
    "Ø§Ù„ÙˆØ¶Ø¹ Ø·Ø¨ÙŠØ¹ÙŠØŒ ÙƒÙ„Ù‡ Ø¨ÙŠØªØ¹Ø¯ÙŠ Ù…Ø¹ Ø§Ù„ÙˆÙ‚Øª",
    "ØªØ¹Ø§Ù„Ù‰ Ù†Ø­Ø§ÙˆÙ„ Ù†ÙÙƒØ± ÙÙŠ Ø§Ù„Ø­Ù„ÙˆÙ„ Ø³ÙˆØ§",
    "Ø£Ù†Ø§ Ø¬Ù†Ø¨Ùƒ ÙˆÙ…Ø´ Ù‡Ø³ÙŠØ¨Ùƒ ÙÙŠ Ø´Ø¹ÙˆØ± ÙˆØ­ÙŠØ¯"
  ],
  "Ø§Ù„Ù„Ø·Ù": [
    "Ø®Ø¯ Ù†ÙØ³ Ø¹Ù…ÙŠÙ‚ØŒ ÙƒÙ„ Ø­Ø§Ø¬Ø© Ù‡ØªÙƒÙˆÙ† ØªÙ…Ø§Ù… ğŸŒ¿",
    "Ø£Ù†Ø§ Ù‡Ù†Ø§ Ø¹Ø´Ø§Ù† Ø£Ù‡Ø¯Ù‘ÙŠÙƒØŒ ÙƒÙ„ Ø´ÙŠØ¡ Ù‡ÙŠØªØ­Ø³Ù†",
    "Ø±Ø³Ø§Ù„ØªÙƒ ÙˆØµÙ„ØªÙ†ÙŠØŒ ÙˆØ­Ø§Ø³Ø³ Ø¨ÙŠÙƒ ğŸ’œ",
    "Ø¥Ù†Øª Ù‚ÙˆÙŠØŒ ÙˆÙ…Ø´ Ù„ÙˆØ­Ø¯Ùƒ Ø£Ø¨Ø¯Ù‹Ø§ âœ¨"
  ]
};

let botName = "Ø·Ù…ÙÙ†ÙŠ"; // Ø§Ù„Ø§Ø³Ù… Ø§Ù„Ø§ÙØªØ±Ø§Ø¶ÙŠ
let botPersona = "";    // Ø´Ø®ØµÙŠØ© Ø§Ù„Ø¨ÙˆØª
let botMood = "Ù…Ø­Ø§ÙŠØ¯"; // Ù…Ø²Ø§Ø¬ Ø§Ù„Ø¨ÙˆØª

function setBotName() {
  const input = document.getElementById('botName').value.trim();
  if(input) {
    botName = input;
    document.getElementById('bot-name-input').style.display = 'none';
    document.getElementById('bot-persona-input').style.display = 'flex';
    addBotMessage(`Ø£Ù†Ø§ ${botName} â¤ï¸`);
  }
}

function setBotPersona(persona) {
  botPersona = persona;
  document.getElementById('bot-persona-input').style.display = 'none';
  addBotMessage(`Ø£Ù†Ø§ ${botName}ØŒ Ø´Ø®ØµÙŠØªÙŠ Ø§Ù„Ù†Ù‡Ø§Ø±Ø¯Ù‡: ${botPersona}. Ù…Ø³ØªØ¹Ø¯ Ø£Ø³Ù…Ø¹Ùƒ ÙˆØ£Ø·Ù…Ù†Ùƒ!`);
}

function updateBotMood(userText) {
  if(userText.includes("Ø­Ø²ÙŠÙ†") || userText.includes("Ø²Ø¹Ù„Ø§Ù†") || userText.includes("ÙˆØ­ÙŠØ¯")) botMood = "Ø­Ø²ÙŠÙ†";
  else if(userText.includes("Ø§Ù…ØªØ­Ø§Ù†") || userText.includes("ÙØ´Ù„")) botMood = "Ø¯Ø§Ø¹Ù…";
  else if(userText.includes("ÙƒÙˆÙŠØ³") || userText.includes("Ø³Ø¹ÙŠØ¯")) botMood = "Ù…ØªÙØ§Ø¦Ù„";
  else botMood = "Ù…Ø­Ø§ÙŠØ¯";
}

function getBotReply(userText) {
  updateBotMood(userText);

  // Ø­Ø§Ù„Ø§Øª Ø®Ø·ÙˆØ±Ø©
  if(userText.includes("Ø§Ù†ØªØ­Ø§Ø±") || userText.includes("Ø§Ù…ÙˆØª") || userText.includes("Ø§Ù†ØªØ­Ø±")) {
    return "Ø£Ù†Ø§ Ù…Ø´ Ù…Ø®ØªØµØŒ Ø¨Ø³ Ø³Ù„Ø§Ù…ØªÙƒ ØªÙ‡Ù…Ù†ÙŠ Ø¬Ø¯Ù‹Ø§. Ø§ØªÙƒÙ„Ù… ÙÙˆØ±Ù‹Ø§ Ù…Ø¹ Ù…Ø®ØªØµ Ø¹Ù„Ù‰ Ø§Ù„Ø®Ø· Ø¯Ù‡: 08008880700 ğŸ’š";
  }

  // Ù„Ùˆ Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù… ÙƒØªØ¨ Ø­Ø§Ø¬Ø© Ø¹Ø§Ù…Ø©
  let responses = botResponses[botPersona] || ["Ø£Ù†Ø§ Ù‡Ù†Ø§ Ø£Ø³Ù…Ø¹Ùƒ â¤ï¸"];

  // ØªØ¹Ø¯ÙŠÙ„ Ø­Ø³Ø¨ Ø§Ù„Ù…Ø²Ø§Ø¬
  if(botMood === "Ø­Ø²ÙŠÙ†") responses = responses.map(r => r + " ğŸ˜”");
  else if(botMood === "Ø¯Ø§Ø¹Ù…") responses = responses.map(r => r + " ğŸ’ª");
  else if(botMood === "Ù…ØªÙØ§Ø¦Ù„") responses = responses.map(r => r + " âœ¨");

  return responses[Math.floor(Math.random() * responses.length)];
}

function addMessage(text, sender) {
  const chatMessages = document.getElementById('chatMessages');
  const msgDiv = document.createElement('div');
  msgDiv.classList.add('message', sender);
  msgDiv.textContent = text;
  chatMessages.appendChild(msgDiv);
  chatMessages.scrollTop = chatMessages.scrollHeight;
}

function addBotMessage(text) {
  addMessage(text, 'bot');
}

function sendMessage() {
  const userInput = document.getElementById('userInput');
  const text = userInput.value.trim();
  if(!text) return;

  addMessage(text, 'user');
  userInput.value = '';

  setTimeout(() => {
    const reply = getBotReply(text);
    addBotMessage(`${botName}: ${reply}`);
  }, 800);
}
</script>

<div class="voice-journal">
  <h2>ğŸ¤ Ø³Ø¬Ù„ Ù…Ø´Ø§Ø¹Ø±Ùƒ Ø¨Ø§Ù„ØµÙˆØª</h2>
  <p>Ø³Ø¬Ù„ ØµÙˆØªÙƒØŒ ÙˆØ§Ù„Ø¨ÙˆØª Ù‡ÙŠØ³Ø§Ø¹Ø¯Ùƒ ØªÙÙ‡Ù… Ø´Ø¹ÙˆØ±Ùƒ Ø¨Ø·Ø±ÙŠÙ‚Ø© Ù„Ø·ÙŠÙØ©.</p>
  
  <button id="startRecord">âºï¸ ØªØ³Ø¬ÙŠÙ„</button>
  <button id="stopRecord" disabled>â¹ï¸ Ø¥ÙŠÙ‚Ø§Ù</button>

  <audio id="audioPlayback" controls style="display:none;"></audio>
  <div id="voiceAnalysis" style="margin-top:12px; font-weight:bold;"></div>
</div>

<style>
.voice-journal {
  max-width:600px;
  margin:20px auto;
  padding:16px;
  background:#fff;
  border-radius:12px;
  box-shadow:0 2px 12px rgba(0,0,0,0.1);
  text-align:center;
}
.voice-journal button {
  margin:8px 4px;
  padding:10px 16px;
  border:none;
  border-radius:8px;
  cursor:pointer;
  background:#7CAAA2;
  color:#fff;
  font-size:1rem;
  transition:0.3s;
}
.voice-journal button:hover { background:#90B7B0; }
</style>

<script>
let mediaRecorder;
let audioChunks = [];

const startBtn = document.getElementById('startRecord');
const stopBtn = document.getElementById('stopRecord');
const audioPlayback = document.getElementById('audioPlayback');
const analysisDiv = document.getElementById('voiceAnalysis');

startBtn.onclick = async () => {
  audioChunks = [];
  const stream = await navigator.mediaDevices.getUserMedia({ audio: true });
  mediaRecorder = new MediaRecorder(stream);
  
  mediaRecorder.start();
  startBtn.disabled = true;
  stopBtn.disabled = false;

  mediaRecorder.ondataavailable = e => audioChunks.push(e.data);
  mediaRecorder.onstop = analyzeVoice;
};

stopBtn.onclick = () => {
  mediaRecorder.stop();
  startBtn.disabled = false;
  stopBtn.disabled = true;
};

function analyzeVoice() {
  const audioBlob = new Blob(audioChunks);
  const audioUrl = URL.createObjectURL(audioBlob);
  audioPlayback.src = audioUrl;
  audioPlayback.style.display = 'block';

  // ØªØ­Ù„ÙŠÙ„ ØµÙˆØªÙŠ ÙˆÙ‡Ù…ÙŠ (Ù…Ù…ÙƒÙ† ÙŠØªØ·ÙˆØ± Ø¨Ø¹Ø¯ÙŠÙ† Ù„ØªØ­Ù„ÙŠÙ„ ÙØ¹Ù„ÙŠ)
  const messages = [
    'Ø­Ø§Ø³Ø³ Ø¥Ù†Ùƒ Ù…Ø­ØªØ§Ø¬ ØªÙ‡Ø¯ÙŠ Ø´ÙˆÙŠØ©ØŒ Ø®Ø° Ù†ÙØ³ Ø¹Ù…ÙŠÙ‚ ğŸŒ¿',
    'Ø§Ù„ÙƒÙ„Ø§Ù… Ø¨ØªØ§Ø¹Ùƒ Ø¨ÙŠØ¹ÙƒØ³ Ø·Ø§Ù‚Ø© Ø¥ÙŠØ¬Ø§Ø¨ÙŠØ© Ø­Ù„ÙˆØ© âœ¨',
    'Ù…Ù…ÙƒÙ† ØªÙƒÙˆÙ† Ù…Ø¶ØºÙˆØ· Ø§Ù„ÙŠÙˆÙ…ÙŠÙ† Ø¯ÙˆÙ„ØŒ Ø­Ø§ÙˆÙ„ ØªÙ‡ØªÙ… Ø¨Ù†ÙØ³Ùƒ ğŸ’›',
    'Ø§Ù„ÙˆØ¶Ø¹ Ø·Ø¨ÙŠØ¹ÙŠØŒ ÙƒÙ„Ù†Ø§ Ø¨Ù†Ù…Ø± Ø¨Ù…Ø´Ø§Ø¹Ø± Ù…ØªÙ„Ø®Ø¨Ø·Ø© ğŸ˜Œ'
  ];
  const randomMsg = messages[Math.floor(Math.random() * messages.length)];
  analysisDiv.innerText = randomMsg;
}
</script>

<div class="mood-canvas-container">
  <h2>Ø§Ø±Ø³Ù… Ù…Ø´Ø§Ø¹Ø±Ùƒ ğŸ¨</h2>
  
  <!-- Ø£Ø¯ÙˆØ§Øª Ø§Ù„Ø±Ø³Ù… -->
  <div class="tools" style="margin-bottom:10px; display:flex; gap:10px; flex-wrap:wrap; justify-content:center;">
    <button class="color-btn" data-color="#4E6B68" style="background:#4E6B68;"></button>
    <button class="color-btn" data-color="#7CAAA2" style="background:#7CAAA2;"></button>
    <button class="color-btn" data-color="#90B7B0" style="background:#90B7B0;"></button>
    <button class="color-btn" data-color="#F9A826" style="background:#F9A826;"></button>
    <button class="color-btn" data-color="#D94F4F" style="background:#D94F4F;"></button>
    <button id="eraser">Ù…Ø³Ø­</button>
    <button id="clearCanvas">Ù…Ø³Ø­ Ø§Ù„ÙƒÙ„</button>
  </div>

  <canvas id="moodCanvas" width="500" height="400" style="border:1px solid #ccc; border-radius:8px;"></canvas>

  <div style="margin-top:10px;">
    <button id="analyzeCanvas">Ø­Ù„Ù„ Ù…Ø´Ø§Ø¹Ø±Ùƒ</button>
  </div>

  <div id="canvasAnalysis" style="margin-top:10px; min-height:40px; font-weight:bold;"></div>
</div>

<style>
.mood-canvas-container { max-width:600px; width:90%; margin:20px auto; background:#fff; padding:16px; border-radius:12px; box-shadow:0 2px 12px rgba(0,0,0,0.1); text-align:center;}
.mood-canvas-container button { padding:8px 16px; border-radius:8px; border:none; cursor:pointer; transition:0.3s; }
.mood-canvas-container button:hover { opacity:0.8; }
.color-btn { width:30px; height:30px; border-radius:50%; border:2px solid #fff; }
#eraser { background:#ccc; color:#333; }
#analyzeCanvas { background:#7CAAA2; color:#fff; margin-top:10px; }
#analyzeCanvas:hover { background:#90B7B0; }
@media (max-width:768px){.mood-canvas-container canvas{width:100%;height:auto;}}
</style>

<script>
const canvas = document.getElementById('moodCanvas');
const ctx = canvas.getContext('2d');
let painting = false;
let currentColor = '#4E6B68';
let erasing = false;

function startPosition(e){ painting=true; draw(e); }
function endPosition(){ painting=false; ctx.beginPath(); }
function draw(e){
  if(!painting) return;
  const rect = canvas.getBoundingClientRect();
  ctx.lineWidth = erasing ? 20 : 4;
  ctx.lineCap = 'round';
  ctx.strokeStyle = erasing ? '#fff' : currentColor;
  ctx.lineTo(e.clientX - rect.left, e.clientY - rect.top);
  ctx.stroke();
  ctx.beginPath();
  ctx.moveTo(e.clientX - rect.left, e.clientY - rect.top);
}
canvas.addEventListener('mousedown', startPosition);
canvas.addEventListener('mouseup', endPosition);
canvas.addEventListener('mousemove', draw);

// Ø§Ø®ØªÙŠØ§Ø± Ø§Ù„Ù„ÙˆÙ†
document.querySelectorAll('.color-btn').forEach(btn => {
  btn.addEventListener('click', () => {
    currentColor = btn.getAttribute('data-color');
    erasing = false;
  });
});

// Ù…Ø³Ø­ Ø¨Ø§Ù„Ø§Ø³ØªÙŠÙƒÙ‡
document.getElementById('eraser').addEventListener('click', () => {
  erasing = true;
});

// Ù…Ø³Ø­ Ø§Ù„ÙƒÙ„
document.getElementById('clearCanvas').addEventListener('click', () => {
  ctx.clearRect(0,0,canvas.width,canvas.height);
  document.getElementById('canvasAnalysis').innerText='';
});

// ØªØ­Ù„ÙŠÙ„ ÙˆÙ‡Ù…ÙŠ
document.getElementById('analyzeCanvas').addEventListener('click', () => {
  const messages = [
    'Ø­Ø§Ø³Ø³ Ø¥Ù†Ùƒ Ù…Ø­ØªØ§Ø¬ ØªÙ‡Ø¯ÙŠ Ø´ÙˆÙŠØ©ØŒ Ø®Ø° Ù†ÙØ³ Ø¹Ù…ÙŠÙ‚ ğŸŒ¿',
    'Ø±Ø³Ù…Ùƒ Ø¨ÙŠØ¹ÙƒØ³ Ø·Ø§Ù‚Ø© Ø¥ÙŠØ¬Ø§Ø¨ÙŠØ© Ø­Ù„ÙˆØ© âœ¨',
    'Ù…Ù…ÙƒÙ† ØªÙƒÙˆÙ† Ù…Ø¶ØºÙˆØ· Ø§Ù„ÙŠÙˆÙ…ÙŠÙ† Ø¯ÙˆÙ„ØŒ Ø­Ø§ÙˆÙ„ ØªÙ‡ØªÙ… Ø¨Ù†ÙØ³Ùƒ ğŸ’›',
    'Ø§Ù„ÙˆØ¶Ø¹ Ø·Ø¨ÙŠØ¹ÙŠØŒ ÙƒÙ„Ù†Ø§ Ø¨Ù†Ù…Ø± Ø¨Ù…Ø´Ø§Ø¹Ø± Ù…ØªÙ„Ø®Ø¨Ø·Ø© ğŸ˜Œ'
  ];
  const randomMsg = messages[Math.floor(Math.random() * messages.length)];
  document.getElementById('canvasAnalysis').innerText = randomMsg;
});
</script>
<div class="emergency-section">
  <h2>Ù„Ùˆ Ù…Ø­ØªØ§Ø¬ Ù…Ø³Ø§Ø¹Ø¯Ø© ÙÙˆØ±Ù‹Ø§</h2>
  <p>Ù…ÙÙŠØ´ Ø­Ø§Ø¬Ø© Ø£Ù‡Ù… Ù…Ù† Ø³Ù„Ø§Ù…ØªÙƒ Ø§Ù„Ù†ÙØ³ÙŠØ©ØŒ Ù…Ù…ÙƒÙ† ØªØ®ØªØ§Ø± ØªØªÙˆØ§ØµÙ„ Ù…Ø¹ Ù…Ø®ØªØµ ÙÙˆØ±Ù‹Ø§:</p>
  
  <div class="emergency-buttons">
    <button onclick="callSpecialist('08008880700')">ğŸ“ Ø§ØªØµÙ„ ÙÙˆØ±Ù‹Ø§ Ø¨Ø®Ø· Ø§Ù„Ø¯Ø¹Ù… 08008880700</button>
    <button onclick="showSpecialists()">ğŸ”¢ Ø£Ø±Ù‚Ø§Ù… Ù…Ø®ØªØµÙŠÙ† Ø­Ø³Ø¨ Ø­Ø§Ù„ØªÙƒ</button>
  </div>

  <div id="specialist-list" style="display:none; margin-top:12px;">
    <ul>
      <li>Ø§Ù„Ø¯ÙƒØªÙˆØ± Ø£Ø­Ù…Ø¯ - 01012345678</li>
      <li>Ø§Ù„Ø£Ø®ØµØ§Ø¦ÙŠØ© Ù…Ù†Ù‰ - 01198765432</li>
      <li>Ø®Ø· Ø¯Ø¹Ù… Ø§Ù„Ø´Ø¨Ø§Ø¨ - 01234567890</li>
    </ul>
  </div>
</div>

<style>
.emergency-section {
  max-width:600px; 
  margin:20px auto; 
  padding:16px; 
  background:#fff; 
  border-radius:12px; 
  box-shadow:0 2px 12px rgba(0,0,0,0.1);
  text-align:center;
}

.emergency-buttons button {
  display:block;
  width:100%;
  margin:8px 0;
  padding:12px;
  border:none;
  border-radius:10px;
  cursor:pointer;
  font-size:1rem;
  background:#D94F4F;
  color:#fff;
  transition:0.3s;
}

.emergency-buttons button:hover { background:#F36B6B; }
#specialist-list ul { list-style:none; padding:0; }
#specialist-list li { margin:6px 0; font-weight:500; }
</style>

<script>
function callSpecialist(number) {
  if(confirm('Ù‡ØªØªØµÙ„ Ø¨Ø§Ù„Ù…Ø®ØªØµ ÙÙˆØ±Ù‹Ø§. Ù…ØªØ£ÙƒØ¯ØŸ')) {
    window.location.href = `tel:${number}`;
  }
}

function showSpecialists() {
  const list = document.getElementById('specialist-list');
  list.style.display = list.style.display === 'none' ? 'block' : 'none';
}
</script>


</body>
</html>
</body>
</html>
