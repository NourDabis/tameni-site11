<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>طمِني | الشات بوت</title>
<style>
/* انسخ كل CSS من index.html الخاص بالـ navbar */
body { margin:0; font-family:Cairo,sans-serif; background-color:#F2F3F0; color:#333; }
.navbar { background-color:#7CAAA2; display:flex; justify-content:space-between; align-items:center; padding:12px 10%; box-shadow:0 2px 8px rgba(0,0,0,0.08); position:sticky; top:0; z-index:100; border-radius:0 0 16px 16px; }
.logo { font-size:1.6rem; font-weight:bold; color:#F9F9F9; }
.navbar ul { list-style:none; display:flex; gap:20px; margin:0; padding:0; align-items:center; }
.navbar li { position:relative; }
.navbar a { color:#fff; text-decoration:none; font-weight:500; padding:8px 14px; border-radius:8px; transition:0.3s ease; }
.navbar a:hover { background-color: rgba(255,255,255,0.15); }
.emergency-link { background-color:#4E6B68; color:#fff !important; font-weight:600; padding:8px 18px; border-radius:12px; box-shadow:0 4px 12px rgba(78,107,104,0.3); transition:0.3s ease, transform 0.2s ease; }
.emergency-link:hover { background-color:#90B7B0; transform:translateY(-2px); }
.accordion-menu { position:relative; }
.accordion-toggle { cursor:pointer; user-select:none; font-weight:600; }
.accordion-content { display:flex; flex-direction:column; position:absolute; top:100%; right:0; background-color:#F2F3F0; border-radius:16px; box-shadow:0 8px 20px rgba(0,0,0,0.1); overflow:hidden; max-height:0; opacity:0; transform:translateY(-10px); transition:max-height 0.4s ease, opacity 0.4s ease, transform 0.3s ease; z-index:99; width:220px; }
.accordion-content.show { max-height:1000px; opacity:1; transform:translateY(0); }
.accordion-content li { list-style:none; }
.accordion-content li a { padding:12px 18px; color:#2E3A3D; font-weight:500; text-decoration:none; border-bottom:1px solid rgba(0,0,0,0.08); transition:background 0.3s, padding-left 0.3s; }
.accordion-content li:last-child a { border-bottom:none; }
.accordion-content li a:hover { background-color:#E7F1EF; padding-left:28px; }
#bot-persona-input button {
  padding: 8px 16px;
  border-radius: 12px;
  border: none;
  background-color: #4E6B68;
  color: #fff;
  cursor: pointer;
  font-weight: 500;
  transition: 0.3s;
}
#bot-persona-input button:hover {
  background-color: #7CAAA2;
}

</style>
</head>
<body>

<header class="navbar">
  <div class="logo">طمِني</div>
  <nav>
    <ul>
      <li><a href="index.html">الرئيسية</a></li>
      <li><a href="about.html">عنّا</a></li>
      <li class="accordion-menu">
        <span class="accordion-toggle">مميزاتنا ▼</span>
        <ul class="accordion-content">
          <li><a href="library.html">المكتبة</a></li>
          <li><a href="tests.html">الاختبارات</a></li>
          <li><a href="mood-tracker.html">متابعة المزاج</a></li>
          <li><a href="stories.html">قصص المراهقين</a></li>
          <li><a href="forum.html">المنتدى</a></li>
        </ul>
      </li>
      <li><a href="emergency.html" class="emergency-link">الطوارئ النفسية</a></li>
      <li><a href="chat.html">الشات بوت</a></li>
    </ul>
  </nav>
</header>


<script>
const toggles = document.querySelectorAll('.accordion-toggle');
toggles.forEach(toggle => {
  toggle.addEventListener('click', (e) => {
    e.stopPropagation();
    const content = toggle.nextElementSibling;
    document.querySelectorAll('.accordion-content').forEach(menu => {
      if(menu !== content) menu.classList.remove('show');
    });
    content.classList.toggle('show');
  });
});
document.addEventListener('click', () => {
  document.querySelectorAll('.accordion-content').forEach(menu => menu.classList.remove('show'));
});
</script>


<style>
body {
  font-family: Cairo, sans-serif;
  background-color: #F2F3F0;
  margin: 0;
  display: flex;
  flex-direction: column;
  min-height: 100vh;
}

.navbar {
  background-color: #7CAAA2;
  display: flex;
  justify-content: space-between;
  align-items: center;
  padding: 12px 5%;
  box-shadow: 0 2px 6px rgba(0,0,0,0.1);
}

.navbar .logo { color: #fff; font-size: 1.6rem; font-weight: bold; }

.chat-container {
  max-width: 400px;      /* عرض محدود */
  width: 90%;
  margin: 40px auto;
  background-color: #fff;
  border-radius: 20px;   /* حواف مدورة زي الصورة */
  box-shadow: 0 8px 24px rgba(0,0,0,0.15); /* ظل خفيف */
  overflow: hidden;
  border: 1px solid #E0E0E0;
  display: flex;
  flex-direction: column;
}

.chat-header {
  background-color: #4E6B68;
  color: #fff;
  text-align: center;
  padding: 16px;
  font-weight: bold;
  font-size: 1.1rem;
}

.chat-messages {
  flex: 1;
  padding: 16px;
  display: flex;
  flex-direction: column;
  gap: 12px;
  overflow-y: auto;
}

.message {
  max-width: 80%;
  padding: 10px 14px;
  border-radius: 16px;
  font-size: 0.95rem;
}

.user { background-color: #7CAAA2; color: #fff; align-self: flex-end; }
.bot { background-color: #F9F9F9; color: #333; align-self: flex-start; border: 1px solid #E0E0E0; }

.chat-input {
  display: flex;
  padding: 12px;
  gap: 8px;
  border-top: 1px solid #E0E0E0;
  background-color: #f8f8f8;
}
.chat-input input {
  flex: 1;
  padding: 10px 14px;
  border-radius: 12px;
  border: 1px solid #ccc;
}

.chat-input button {
  padding: 10px 16px;
  background-color: #4E6B68;
  color: #fff;
  border: none;
  border-radius: 12px;
  cursor: pointer;
}
.chat-input button:hover { background-color: #7CAAA2; }
.chat-buttons {
  display: flex;
  gap: 8px;
  flex-wrap: wrap;
  justify-content: center;
  padding: 12px;
}

.chat-buttons button {
  background-color: #E7F1EF;
  color: #2E3A3D;
  border: none;
  padding: 8px 12px;
  border-radius: 12px;
  cursor: pointer;
  transition: 0.3s;
}
.chat-buttons button:hover {
  background-color: #D4EBE6;
}

/* اسم البوت */
#bot-name-input {
  display: flex;
  gap: 8px;
  padding: 12px;
  justify-content: center;
  align-items: center;
  background-color: #E7F1EF;
  flex-wrap: wrap;
}
#bot-name-input input {
  padding: 6px 10px;
  border-radius: 6px;
  border: 1px solid #ccc;
  flex: 1 1 150px;
}
#bot-name-input button {
  padding: 6px 12px;
  border-radius: 6px;
  border: none;
  background-color: #4E6B68;
  color: #fff;
  cursor: pointer;
}
#bot-name-input button:hover { background-color: #7CAAA2; }

/* ----- Responsive ----- */
@media (max-width: 768px) {
  .chat-container {
    width: 95%;
    margin: 10px auto;
  }
  .chat-input input, #bot-name-input input {
    font-size: 0.9rem;
  }
  .chat-header {
    font-size: 1rem;
  }
}
</style>
</head>
<body>


<!-- اختيار اسم البوت -->
<div id="bot-name-input">
  <input type="text" id="botName" placeholder="اكتب اسم البوت اللي تحبه">
  <button onclick="setBotName()">اختيار الاسم</button>
</div>

<!-- اختيار شخصية البوت -->
<div id="bot-persona-input" style="display:none; flex-direction:column; gap:10px; text-align:center; margin:20px 0;">
  <h3>اختار شخصية البوت اللي تحب تتكلم معاها:</h3>
  <div style="display:flex; gap:10px; justify-content:center; flex-wrap:wrap;">
    <button onclick="setBotPersona('الدكتور')">الدكتور</button>
    <button onclick="setBotPersona('الصاحب')">الصاحب</button>
    <button onclick="setBotPersona('الأخت')">الأخت</button>
    <button onclick="setBotPersona('الأخ')">الأخ</button>
    <button onclick="setBotPersona('اللطف')">اللطف</button>
  </div>
</div>

<div class="chat-container">
  <div class="chat-header">🌸 طمِني ChatBot</div>
  <div class="chat-messages" id="chatMessages"></div>

  <div class="chat-buttons">
    <button>مرحبا </button>
    <button>اريد ان اخبرك شيئا</button>
    <button>انا اشعر بالحزن</button>
  </div>

  <div class="chat-input">
    <input type="text" id="userInput" placeholder="اكتب رسالتك هنا..." onkeydown="if(event.key==='Enter'){sendMessage();}">
    <button onclick="sendMessage()">إرسال</button>
  </div>
</div>


<script>
const botResponses = {
  "الدكتور": [
    "خلينا نفكر مع بعض بهدوء عن اللي مضايقك...",
    "أنا موجود هنا لمساعدتك تفهم شعورك 🌿",
    "أحيانًا بس الحوار مع حد ممكن يخفف الضغط النفسي",
    "حسيت بحاجة مضايقاك؟ احكيلي بالتفصيل، خطوة خطوة"
  ],
  "الصاحب": [
    "حسيت إنك زعلان، أنا معاك ❤️",
    "تعالى نضحك شوية، الدنيا مش دايمًا كده 😎",
    "أنا جنبك، متقلقش",
    "ممكن نحكي عن أي حاجة تحبها"
  ],
  "الأخت": [
    "يا حبيبي، أنا جنبك ومسمعتك 💛",
    "حسيت إنك محتاج حضن افتراضي 🤗",
    "خد وقتك وشارك اللي جواك، أنا سامعة",
    "أنا هنا عشانك دايمًا 🌸"
  ],
  "الأخ": [
    "متقلقش، أنا معاك وهطمنك 😌",
    "الوضع طبيعي، كله بيتعدي مع الوقت",
    "تعالى نحاول نفكر في الحلول سوا",
    "أنا جنبك ومش هسيبك في شعور وحيد"
  ],
  "اللطف": [
    "خد نفس عميق، كل حاجة هتكون تمام 🌿",
    "أنا هنا عشان أهدّيك، كل شيء هيتحسن",
    "رسالتك وصلتني، وحاسس بيك 💜",
    "إنت قوي، ومش لوحدك أبدًا ✨"
  ]
};

let botName = "طمِني"; // الاسم الافتراضي
let botPersona = "";    // شخصية البوت
let botMood = "محايد"; // مزاج البوت

function setBotName() {
  const input = document.getElementById('botName').value.trim();
  if(input) {
    botName = input;
    document.getElementById('bot-name-input').style.display = 'none';
    document.getElementById('bot-persona-input').style.display = 'flex';
    addBotMessage(`أنا ${botName} ❤️`);
  }
}

function setBotPersona(persona) {
  botPersona = persona;
  document.getElementById('bot-persona-input').style.display = 'none';
  addBotMessage(`أنا ${botName}، شخصيتي النهارده: ${botPersona}. مستعد أسمعك وأطمنك!`);
}

function updateBotMood(userText) {
  if(userText.includes("حزين") || userText.includes("زعلان") || userText.includes("وحيد")) botMood = "حزين";
  else if(userText.includes("امتحان") || userText.includes("فشل")) botMood = "داعم";
  else if(userText.includes("كويس") || userText.includes("سعيد")) botMood = "متفائل";
  else botMood = "محايد";
}

function getBotReply(userText) {
  updateBotMood(userText);

  // حالات خطورة
  if(userText.includes("انتحار") || userText.includes("اموت") || userText.includes("انتحر")) {
    return "أنا مش مختص، بس سلامتك تهمني جدًا. اتكلم فورًا مع مختص على الخط ده: 08008880700 💚";
  }

  // لو المستخدم كتب حاجة عامة
  let responses = botResponses[botPersona] || ["أنا هنا أسمعك ❤️"];

  // تعديل حسب المزاج
  if(botMood === "حزين") responses = responses.map(r => r + " 😔");
  else if(botMood === "داعم") responses = responses.map(r => r + " 💪");
  else if(botMood === "متفائل") responses = responses.map(r => r + " ✨");

  return responses[Math.floor(Math.random() * responses.length)];
}

function addMessage(text, sender) {
  const chatMessages = document.getElementById('chatMessages');
  const msgDiv = document.createElement('div');
  msgDiv.classList.add('message', sender);
  msgDiv.textContent = text;
  chatMessages.appendChild(msgDiv);
  chatMessages.scrollTop = chatMessages.scrollHeight;
}

function addBotMessage(text) {
  addMessage(text, 'bot');
}

function sendMessage() {
  const userInput = document.getElementById('userInput');
  const text = userInput.value.trim();
  if(!text) return;

  addMessage(text, 'user');
  userInput.value = '';

  setTimeout(() => {
    const reply = getBotReply(text);
    addBotMessage(`${botName}: ${reply}`);
  }, 800);
}
</script>

<div class="voice-journal">
  <h2>🎤 سجل مشاعرك بالصوت</h2>
  <p>سجل صوتك، والبوت هيساعدك تفهم شعورك بطريقة لطيفة.</p>
  
  <button id="startRecord">⏺️ تسجيل</button>
  <button id="stopRecord" disabled>⏹️ إيقاف</button>

  <audio id="audioPlayback" controls style="display:none;"></audio>
  <div id="voiceAnalysis" style="margin-top:12px; font-weight:bold;"></div>
</div>

<style>
.voice-journal {
  max-width:600px;
  margin:20px auto;
  padding:16px;
  background:#fff;
  border-radius:12px;
  box-shadow:0 2px 12px rgba(0,0,0,0.1);
  text-align:center;
}
.voice-journal button {
  margin:8px 4px;
  padding:10px 16px;
  border:none;
  border-radius:8px;
  cursor:pointer;
  background:#7CAAA2;
  color:#fff;
  font-size:1rem;
  transition:0.3s;
}
.voice-journal button:hover { background:#90B7B0; }
</style>

<script>
let mediaRecorder;
let audioChunks = [];

const startBtn = document.getElementById('startRecord');
const stopBtn = document.getElementById('stopRecord');
const audioPlayback = document.getElementById('audioPlayback');
const analysisDiv = document.getElementById('voiceAnalysis');

startBtn.onclick = async () => {
  audioChunks = [];
  const stream = await navigator.mediaDevices.getUserMedia({ audio: true });
  mediaRecorder = new MediaRecorder(stream);
  
  mediaRecorder.start();
  startBtn.disabled = true;
  stopBtn.disabled = false;

  mediaRecorder.ondataavailable = e => audioChunks.push(e.data);
  mediaRecorder.onstop = analyzeVoice;
};

stopBtn.onclick = () => {
  mediaRecorder.stop();
  startBtn.disabled = false;
  stopBtn.disabled = true;
};

function analyzeVoice() {
  const audioBlob = new Blob(audioChunks);
  const audioUrl = URL.createObjectURL(audioBlob);
  audioPlayback.src = audioUrl;
  audioPlayback.style.display = 'block';

  // تحليل صوتي وهمي (ممكن يتطور بعدين لتحليل فعلي)
  const messages = [
    'حاسس إنك محتاج تهدي شوية، خذ نفس عميق 🌿',
    'الكلام بتاعك بيعكس طاقة إيجابية حلوة ✨',
    'ممكن تكون مضغوط اليومين دول، حاول تهتم بنفسك 💛',
    'الوضع طبيعي، كلنا بنمر بمشاعر متلخبطة 😌'
  ];
  const randomMsg = messages[Math.floor(Math.random() * messages.length)];
  analysisDiv.innerText = randomMsg;
}
</script>

<div class="mood-canvas-container">
  <h2>ارسم مشاعرك 🎨</h2>
  
  <!-- أدوات الرسم -->
  <div class="tools" style="margin-bottom:10px; display:flex; gap:10px; flex-wrap:wrap; justify-content:center;">
    <button class="color-btn" data-color="#4E6B68" style="background:#4E6B68;"></button>
    <button class="color-btn" data-color="#7CAAA2" style="background:#7CAAA2;"></button>
    <button class="color-btn" data-color="#90B7B0" style="background:#90B7B0;"></button>
    <button class="color-btn" data-color="#F9A826" style="background:#F9A826;"></button>
    <button class="color-btn" data-color="#D94F4F" style="background:#D94F4F;"></button>
    <button id="eraser">مسح</button>
    <button id="clearCanvas">مسح الكل</button>
  </div>

  <canvas id="moodCanvas" width="500" height="400" style="border:1px solid #ccc; border-radius:8px;"></canvas>

  <div style="margin-top:10px;">
    <button id="analyzeCanvas">حلل مشاعرك</button>
  </div>

  <div id="canvasAnalysis" style="margin-top:10px; min-height:40px; font-weight:bold;"></div>
</div>

<style>
.mood-canvas-container { max-width:600px; width:90%; margin:20px auto; background:#fff; padding:16px; border-radius:12px; box-shadow:0 2px 12px rgba(0,0,0,0.1); text-align:center;}
.mood-canvas-container button { padding:8px 16px; border-radius:8px; border:none; cursor:pointer; transition:0.3s; }
.mood-canvas-container button:hover { opacity:0.8; }
.color-btn { width:30px; height:30px; border-radius:50%; border:2px solid #fff; }
#eraser { background:#ccc; color:#333; }
#analyzeCanvas { background:#7CAAA2; color:#fff; margin-top:10px; }
#analyzeCanvas:hover { background:#90B7B0; }
@media (max-width:768px){.mood-canvas-container canvas{width:100%;height:auto;}}
</style>

<script>
const canvas = document.getElementById('moodCanvas');
const ctx = canvas.getContext('2d');
let painting = false;
let currentColor = '#4E6B68';
let erasing = false;

function startPosition(e){ painting=true; draw(e); }
function endPosition(){ painting=false; ctx.beginPath(); }
function draw(e){
  if(!painting) return;
  const rect = canvas.getBoundingClientRect();
  ctx.lineWidth = erasing ? 20 : 4;
  ctx.lineCap = 'round';
  ctx.strokeStyle = erasing ? '#fff' : currentColor;
  ctx.lineTo(e.clientX - rect.left, e.clientY - rect.top);
  ctx.stroke();
  ctx.beginPath();
  ctx.moveTo(e.clientX - rect.left, e.clientY - rect.top);
}
canvas.addEventListener('mousedown', startPosition);
canvas.addEventListener('mouseup', endPosition);
canvas.addEventListener('mousemove', draw);

// اختيار اللون
document.querySelectorAll('.color-btn').forEach(btn => {
  btn.addEventListener('click', () => {
    currentColor = btn.getAttribute('data-color');
    erasing = false;
  });
});

// مسح بالاستيكه
document.getElementById('eraser').addEventListener('click', () => {
  erasing = true;
});

// مسح الكل
document.getElementById('clearCanvas').addEventListener('click', () => {
  ctx.clearRect(0,0,canvas.width,canvas.height);
  document.getElementById('canvasAnalysis').innerText='';
});

// تحليل وهمي
document.getElementById('analyzeCanvas').addEventListener('click', () => {
  const messages = [
    'حاسس إنك محتاج تهدي شوية، خذ نفس عميق 🌿',
    'رسمك بيعكس طاقة إيجابية حلوة ✨',
    'ممكن تكون مضغوط اليومين دول، حاول تهتم بنفسك 💛',
    'الوضع طبيعي، كلنا بنمر بمشاعر متلخبطة 😌'
  ];
  const randomMsg = messages[Math.floor(Math.random() * messages.length)];
  document.getElementById('canvasAnalysis').innerText = randomMsg;
});
</script>
<div class="emergency-section">
  <h2>لو محتاج مساعدة فورًا</h2>
  <p>مفيش حاجة أهم من سلامتك النفسية، ممكن تختار تتواصل مع مختص فورًا:</p>
  
  <div class="emergency-buttons">
    <button onclick="callSpecialist('08008880700')">📞 اتصل فورًا بخط الدعم 08008880700</button>
    <button onclick="showSpecialists()">🔢 أرقام مختصين حسب حالتك</button>
  </div>

  <div id="specialist-list" style="display:none; margin-top:12px;">
    <ul>
      <li>الدكتور أحمد - 01012345678</li>
      <li>الأخصائية منى - 01198765432</li>
      <li>خط دعم الشباب - 01234567890</li>
    </ul>
  </div>
</div>

<style>
.emergency-section {
  max-width:600px; 
  margin:20px auto; 
  padding:16px; 
  background:#fff; 
  border-radius:12px; 
  box-shadow:0 2px 12px rgba(0,0,0,0.1);
  text-align:center;
}

.emergency-buttons button {
  display:block;
  width:100%;
  margin:8px 0;
  padding:12px;
  border:none;
  border-radius:10px;
  cursor:pointer;
  font-size:1rem;
  background:#D94F4F;
  color:#fff;
  transition:0.3s;
}

.emergency-buttons button:hover { background:#F36B6B; }
#specialist-list ul { list-style:none; padding:0; }
#specialist-list li { margin:6px 0; font-weight:500; }
</style>

<script>
function callSpecialist(number) {
  if(confirm('هتتصل بالمختص فورًا. متأكد؟')) {
    window.location.href = `tel:${number}`;
  }
}

function showSpecialists() {
  const list = document.getElementById('specialist-list');
  list.style.display = list.style.display === 'none' ? 'block' : 'none';
}
</script>


</body>
</html>
</body>
</html>
